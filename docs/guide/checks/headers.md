# Headers Check

Analyzes HTTP security headers using the drHEADer rule engine.

- **Check type:** `headers`
- **Endpoint:** `POST /v1/check/headers`
- **Default:** Yes (all targets)
- **Deep variant:** None

## What Is Checked

- Presence and correctness of security headers (Content-Security-Policy, Strict-Transport-Security, X-Frame-Options, X-Content-Type-Options, Referrer-Policy, Permissions-Policy, etc.)
- HTTPS enforcement (whether the target redirects to or serves over HTTPS)
- CSP report-only mode without an enforcing policy
- Redirect behavior (the scanner does **not** follow redirects — it analyzes headers from the exact URL you provide)

## Redirect Handling

The headers scanner intentionally does **not** follow HTTP redirects. When you scan `example.com` and it returns a 301 redirect to `www.example.com`, the scanner analyzes headers from the `example.com` response itself. This is important because:

- **HSTS on bare domains matters.** If `example.com` redirects to `www.example.com` but doesn't set `Strict-Transport-Security`, the bare domain is vulnerable to man-in-the-middle attacks on the first visit.
- **You get what you asked for.** The headers reported are for the exact target you scanned, not a different domain the target happens to redirect to.

When a redirect is detected, an informational finding is included with the redirect destination. To check the destination's headers, scan it separately.

## Understanding Findings

| Severity | Example findings |
|----------|-----------------|
| high | Missing Strict-Transport-Security, HTTPS→HTTP redirect downgrade |
| medium | Missing Content-Security-Policy, CSP in report-only mode without enforcement |
| low | Missing Referrer-Policy, missing Permissions-Policy |
| info | HTTPS enforced, redirect detected |

Findings are generated by the drHEADer rule engine, which evaluates headers against established security best practices. Each finding explains which header is missing or misconfigured and why it matters.

## Raw Data Fields

| Field | Description |
|-------|-------------|
| `url` | URL that was checked (the target itself, not a redirect destination) |
| `status_code` | HTTP response status code (may be 3xx if the target redirects) |
| `headers` | All response headers as key-value pairs |
| `redirect_location` | Redirect destination URL (only present when `status_code` is 3xx) |

---

[Back to overview](../README.md) | [Getting Started](../getting-started.md)
